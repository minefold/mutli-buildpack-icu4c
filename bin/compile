#!/bin/sh

ICU_SRC_URL="http://download.icu-project.org/files/icu4c/50.1.1/icu4c-50_1_1-src.tgz"

indent() {
  sed -u 's/^/       /'
}

if [ -d $2/icu4c ]
then
  echo "-----> Building icu4c from cache"
else
  echo "-----> Building icu4c"

  mkdir -p $2
  cd $2

  curl $ICU_SRC_URL | tar xz

  # Build

  cd icu/source
  chmod +x runConfigureICU configure install-sh

  ./runConfigureICU Linux | indent
  make | indent

  # Cleanup

  cd $2
  mv icu/source icu4c
  rm -rf icu
fi

cp -r $2/icu4c $1/vendor/icu4c

if [ -d $1/vendor/icu4c ];
  echo "-----> Installed icu4c"
else
  echo "       Error installing icu4c"
  exit 1
fi
